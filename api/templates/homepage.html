{% extends "header.html" %}

{% block title %}
Homepage
{% endblock %}

{% load static %}
{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'styles/post_view.css' %}">
{% endblock %}

{% block content %}

<!-- Create post modal window -->
<div class="modal fade" id="create_post_modal" style="top: 15%; text-align: left;" 
    aria-labelledby="create_post_title" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Header -->
            <div class="modal-header">
                <h4 id="create_post_title">Create Post</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <form method="POST" action="api/author/{{ author.authorID }}/posts">
                    <!-- PUT - Create a post with generate post_id -->
                    <input type="hidden" name="myCustom_method" value="PUT"/>
                    {% csrf_token %}
                    <!-- Title -->
                    <div class="form-group">
                        <input type="text" name="title" class="" placeholder="Title" required> 
                    </div>
                    <!-- Description -->
                    <div class="form-group">
                        <input type="text" name="description" class="" placeholder="Description">
                    </div>
                    <!-- Content -->
                    <div class="form-group">
                        <textarea type="text" name="content" class="" placeholder="Content"></textarea>
                    </div>
                    <!-- Image -->
                    <div class="form-group">
                        Image<input type="file" name="image" class="" placeholder="Image">
                    </div>
                    <!-- Categories -->
                    <div class="form-group">
                        <input type="text" name="categories" class="" placeholder="Categories">
                    </div>
                    <!-- Visibility --><!--
                    <div class="form-group">
                        Public<input type="radio" name="visibility" class="" value="Public" checked>
                        Friends<input type="radio" name="visibility" class="" value="Friends">
                    </div>-->
                    <!-- Unlisted -->
                    <div class="form-group">
                        Unlisted<input type="checkbox" name="unlisted" class="" value="unlisted">
                    </div>
                    <!-- Source -->
                    <div class="form-group">
                        <input type="url" name="source" class="" placeholder="Source"> 
                    </div>
                    <!-- Origin -->
                    <div class="form-group">
                        <input type="url" name="origin" class="" placeholder="Origin">
                    </div>
                    <!-- Post Button -->
                    <input type="submit" class="btn btn-info" value="POST">
                </form>
            </div>

        </div>
    </div>
</div>

<div class="container text-center" style="margin-top: 30px;">
    
    <!-- Button for create post window -->
    <label role="button" class="btn btn-primary" data-bs-toggle="modal" 
        data-bs-target="#create_post_modal">Create Post</label>

    {% for post in public_post %}
    <!-- Post -->
    <div class="myCustom_card" style="margin: 30px;">

        <!-- Header - Title and date -->
        <div class="card-header">
            <h2 style="margin-top: 10px;">{{ post.title }}</h2>
            Post by <a href="{% url 'profile' authorID=post.author.authorID %}"
                style="text-decoration: none; font-size: 14pt;">{{ post.author.displayName }}</a> <br>
            Last release - {{ post.published }}
        </div>

        <!-- Body - Contents -->
        <div class="card-body">
            <div class="post_contents">
                Description: {{ post.description }} <br>
                Content: {{ post.content }} <br>
                Image: {{ post.image }} <br>
                Categories: {{ post.categories }} <br>
                Source: {{ post.source }} <br>
                Origin: {{ post.origin }} <br>
            </div>

            <hr>

            <!-- Footer - Button of operating -->
            <div class="management_button_area">
                <button type="button" class="btn btn-primary">Share</button>
                <!-- Button of Post Like SHOW -->
                <button type="button" class="btn btn-primary myCustom_like_post_show" data-bs-toggle="modal" 
                    data-bs-target="#modal_like_post_{{ post.postID }}_author_{{ post.author.authorID }}">Like</button>
                <!-- Button of Comment SHOW -->
                <button type="button" class="btn btn-primary myCustom_comment_show" 
                    data-bs-toggle="collapse" 
                    data-bs-target="#comment_post_{{ post.postID }}_author_{{ post.author.authorID }}" 
                    aria-expanded="false" 
                    aria-controls="comment_post_{{ post.postID }}_author_{{ post.author.authorID }}">
                    Comment
                </button>

                <!-- View of Comment SHOW -->
                <div class="collapse" id="comment_post_{{ post.postID }}_author_{{ post.author.authorID }}">
                    <input type="hidden" id="myCustom_comment_button_clicked_{{ post.postID }}" value="false">
                    <br>
                    <div class="myCustom_comment_card card-body">
                        <!-- Write a comment -->
                        <div class="" id="write_a_comment_area">
                            <input type="text" id="comment_input_{{ post.postID }}" name="content" class="" placeholder="Comment">
                            <button type="button" 
                            class="btn btn-primary myCustom_comment_send" 
                                var="{{ post.postID }}" 
                                value="{{ author.authorID }}_poster_{{ post.author.authorID }}">
                                Send
                            </button>
                        </div>
                        
                        <!-- Show comments -->
                        <div id="comment_{{ post.postID }}_author_{{ post.author.authorID }}"></div>
                    </div>
                </div>

                <!-- View of Post Like SHOW -->
                <!-- Create post modal window -->
                <div class="modal fade" id="modal_like_post_{{ post.postID }}_author_{{ post.author.authorID }}" 
                    style="top: 15%; text-align: center;" aria-labelledby="like_post_title" aria-hidden="true">
                    <input type="hidden" id="myCustom_like_post_button_clicked_{{ post.postID }}" value="false">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <!-- Header -->
                            <div class="modal-header">
                                <h4 id="like_post_title">Likes of this Post</h4>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>

                            <!-- Body -->
                            <div class="modal-body">
                                <h5 id="like_post_content_{{ post.postID }}">Click 'Like' Button to Liked this Post</h5>
                                <button id="button_like_post_{{ post.postID }}_author_{{ author.authorID }}"
                                    type="button" class="btn btn-primary">Like</button>
                            </div>

                            <!-- Footer -->
                            <div class="modal-footer">
                                <div id="like_post_{{ post.postID }}"></div>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    {% endfor %}

</div>

<br><br><br>

{% endblock %}

{% block script %}
<script type="text/javascript" src="{% static 'scripts/comments.js' %}"></script>
{% endblock %}
