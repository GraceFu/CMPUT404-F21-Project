{% extends "header.html" %}

{% block title %}
My Posts
{% endblock %}

{% block content %}

<div class="container">
    {% for post in self_post %}

    <!-- Post -->
    <div class="" style="margin: 30px; padding: 20px; border: solid 2px; border-radius: 10px;">
        <!-- Header - Title and date -->
        <div class="post_title">
            Post by {{ user.author.displayName }} <br>
            Last release - {{ post.published }} <br>
            <h2>{{ post.title }}<h3>
        </div>

        <hr>

        <!-- Body - Contents -->
        <div class="post_contents">
            Description: {{ post.description }} <br>
            Content: {{ post.content }} <br>
            Image: {{ post.image }} <br>
            Categories: {{ post.categories }} <br>
            Visibility: {{ post.visibility }} <br>
            Unlisted: {{ post.unlisted }} <br>
            Source: {{ post.source }} <br>
            Origin: {{ post.origin }} <br>
        </div>

        <hr>

        <!-- Footer - Button of operating -->
        <div class="management_button_area">
            <button type="button" data-bs-toggle="modal" data-bs-target="#edit_post_modal_{{ post.postID }}" disabled>Edit</button>
            <button type="button" data-bs-toggle="modal" data-bs-target="#delete_post_modal_{{ post.postID }}">Delete</button>
        </div>
    </div>

    <!-- Create post modal window -->
    <div class="modal fade" id="edit_post_modal_{{ post.postID }}" style="top: 15%;">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Header -->
                <div class="modal-header">
                    <h4>Edit Post</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Body -->
                <div class="modal-body">
                    <form method="POST" action="author/{{ user.author.authorID }}/posts">
                        <!-- POST - Update the post -->
                        <input type="hidden" name="myCustom_method" value="POST"/>
                        <input type="hidden" name="myCustom_postID" value="{{ post.postID }}"/>

                        {% csrf_token %}
                        <!-- Title -->
                        <div class="form-group">
                            <input type="text" name="title" class="" placeholder="Title" value="{{ post.title }}" required> 
                        </div>
                        <!-- Description -->
                        <div class="form-group">
                            <input type="text" name="description" class="" placeholder="Description" value="{{ post.description }}">
                        </div>
                        <!-- Content -->
                        <div class="form-group">
                            <textarea type="text" name="content" class="" placeholder="Content">{{ post.content }}</textarea>
                        </div>
                        <!-- Image -->
                        <div class="form-group">
                            Image<input type="file" name="image" class="" placeholder="Image">
                        </div>
                        <!-- Categories -->
                        <div class="form-group">
                            <input type="text" name="categories" class="" placeholder="Categories" value="{{ post.categories }}">
                        </div>
                        <!-- Visibility --><!--
                        <div class="form-group">
                            Public<input type="radio" name="visibility" class="" value="Public" checked>
                            Friends<input type="radio" name="visibility" class="" value="Friends">
                        </div>-->
                        <!-- Unlisted -->
                        <div class="form-group">
                            Unlisted<input type="checkbox" name="unlisted" class="" value="unlisted">
                        </div>
                        <!-- Source -->
                        <div class="form-group">
                            <input type="url" name="source" class="" placeholder="Source" value="{{ post.source }}"> 
                        </div>
                        <!-- Origin -->
                        <div class="form-group">
                            <input type="url" name="origin" class="" placeholder="Origin" value="{{ post.origin }}">
                        </div>
                        <!-- Update Button -->
                        <input type="submit" class="btn btn-info" value="Update">
                    </form>
                </div>

            </div>
        </div>
    </div>

    <!-- Create post modal window -->
    <div class="modal fade" id="delete_post_modal_{{ post.postID }}" style="top: 30%;">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Header -->
                <div class="modal-header">
                    <h4>Delete Post</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Body -->
                <div class="modal-body">
                    <form method="POST" action="author/{{ user.author.authorID }}/posts">
                        <!-- POST - Update the post -->
                        <input type="hidden" name="myCustom_method" value="DELETE"/>
                        <input type="hidden" name="myCustom_postID" value="{{ post.postID }}"/>

                        {% csrf_token %}
                        <!-- Message -->
                        <p>Are you sure you want to delete this post? To confirm, please click Delete.</p>
                        <!-- Delete Button -->
                        <input type="submit" class="btn btn-info" value="Delete">
                    </form>
                </div>

            </div>
        </div>
    </div>

    {% endfor %}
</div>

{% endblock %}